<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>persian AI - {{ model_name }}</title>
  <style>
        .bodyCHAT {
  margin: 0;
  padding: 0;
  font-family: 'Roboto', sans-serif;
  background: linear-gradient(to bottom, #1e1e2f, #121212);
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

/* Container */
.containerCHAT {
  display: flex;
  width: 90%;
  max-width: 1200px;
  height: 80%;
  background: #1b1b29;
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
  overflow: hidden;
}

/* Sidebar */
.sidebarCHAT {
  width: 25%;
  background: linear-gradient(to bottom, #2a2a40, #1f1f30);
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  box-shadow: 2px 0 15px rgba(0, 0, 0, 0.4);
}

.logoCHAT {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: #00d4ff;
  text-transform: uppercase;
  text-shadow: 0 0 10px #00d4ff, 0 0 20px #007bff;
}

.contactsCHAT {
  list-style: none;
  padding: 0;
  margin: 0;
  width: 100%;
}

.contactCHAT {
  padding: 15px 20px;
  margin-bottom: 10px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.05);
  cursor: pointer;
  color: white;
  font-size: 1rem;
  transition: background 0.3s, transform 0.2s;
}

.contactCHAT:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.05);
}

.activeCHAT {
  background: linear-gradient(to right, #007bff, #00d4ff);
}

/* Chat Window */
.chatWindowCHAT {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  background: #12121b;
}

.headerCHAT {
  padding: 20px;
  background: #1e1e2f;
  color: white;
  text-align: center;
  font-size: 1.5rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.messagesCHAT {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

/* Messages */
.messageCHAT {
  max-width: 60%;
  padding: 15px;
  border-radius: 15px;
  font-size: 1rem;
  line-height: 1.4;
}

.botCHAT {
  background: linear-gradient(to right, #007bff, #00d4ff);
  color: white;
  align-self: flex-start;
}

.userCHAT {
  background: linear-gradient(to right, #00ff99, #00d4b3);
  color: black;
  align-self: flex-end;
}

/* Input Container */
.inputContainerCHAT {
  display: flex;
  padding: 20px;
  background: #1e1e2f;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.inputCHAT {
  flex: 1;
  padding: 15px;
  border: none;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 30px;
  color: white;
  font-size: 1rem;
  outline: none;
}

.inputCHAT::placeholder {
  color: rgba(255, 255, 255, 0.5);
}

.sendButtonCHAT {
  padding: 15px 20px;
  margin-left: 10px;
  border: none;
  background: linear-gradient(to right, #007bff, #00d4ff);
  color: white;
  border-radius: 30px;
  font-size: 1rem;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
}

.sendButtonCHAT:hover {
  transform: scale(1.1);
  box-shadow: 0 10px 20px rgba(0, 212, 255, 0.5);
}
/* Comments Section */
.commentsSectionCHAT {
    margin-top: 40px;
    background-color: #12121b;
    padding: 20px;
    border-radius: 10px;
}

/* Single Comment */
.commentCHAT {
    background-color: #1b1b29;
    color: white;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 10px;
}

.commentCHAT .authorCHAT {
    font-weight: bold;
    margin-bottom: 5px;
}

.commentCHAT .contentCHAT {
    font-size: 1rem;
}

/* Comment Form */
.commentFormCHAT {
    display: flex;
    flex-direction: column;
}

.commentFormCHAT input,
.commentFormCHAT textarea {
    padding: 10px;
    margin-bottom: 10px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 1rem;
}

.commentFormCHAT button {
    padding: 10px;
    background: linear-gradient(to right, #007bff, #00d4ff);
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: transform 0.3s;
}

.commentFormCHAT button:hover {
    transform: scale(1.05);
}
/* Login Form */
.loginFormCHAT {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-width: 400px;
    background: #1b1b29;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
}

/* Form Header */
.headerCHAT {
    font-size: 1.5rem;
    color: white;
    margin-bottom: 20px;
    text-align: center;
}

/* Input Fields */
.inputFieldCHAT {
    margin-bottom: 20px;
    width: 100%;
}

.inputLabelCHAT {
    display: block;
    color: white;
    margin-bottom: 5px;
    font-size: 1rem;
}

.inputCHAT {
    width: 100%;
    padding: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 1rem;
    outline: none;
}

.inputCHAT::placeholder {
    color: rgba(255, 255, 255, 0.5);
}

/* Login Button */
.loginButtonCHAT {
    width: 100%;
    padding: 15px;
    background: linear-gradient(to right, #007bff, #00d4ff);
    color: white;
    border: none;
    border-radius: 30px;
    font-size: 1rem;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}

.loginButtonCHAT:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 212, 255, 0.5);
}
/* Admin Dashboard */
.mainContentCHAT {
    flex: 1;
    padding: 20px;
    background: #12121b;
    color: white;
    display: flex;
    flex-direction: column;
}

/* Sidebar */
.sidebarCHAT {
    width: 250px;
    background: linear-gradient(to bottom, #2a2a40, #1f1f30);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    box-shadow: 2px 0 15px rgba(0, 0, 0, 0.4);
}

.logoCHAT {
    font-size: 2rem;
    margin-bottom: 30px;
    color: #00d4ff;
    text-transform: uppercase;
    text-shadow: 0 0 10px #00d4ff, 0 0 20px #007bff;
}

.navLinksCHAT {
    list-style: none;
    padding: 0;
    margin: 0;
    width: 100%;
}

.navLinkCHAT {
    width: 100%;
    margin: 15px 0;
    text-align: center;
}

.navLinkCHAT a {
    color: white;
    text-decoration: none;
    font-size: 1.2rem;
    display: block;
    padding: 10px;
    transition: background 0.3s;
}

.navLinkCHAT a:hover {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
}

/* Header */
.headerCHAT {
    font-size: 2rem;
    margin-bottom: 30px;
    text-align: center;
    color: white;
}

/* Stats */
.statsCHAT {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
}

.statCardCHAT {
    background: #1b1b29;
    padding: 20px;
    width: 30%;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
}

.statCardCHAT h3 {
    margin-bottom: 10px;
}

.statCardCHAT p {
    font-size: 2rem;
    font-weight: bold;
}

/* User List */
.userListCHAT {
    background: #1b1b29;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
}

.userTableCHAT {
    width: 100%;
    border-collapse: collapse;
}

.userTableCHAT th,
.userTableCHAT td {
    padding: 15px;
    text-align: left;
}

.userTableCHAT th {
    background: #2a2a40;
    color: white;
}

.userTableCHAT td {
    background: #1b1b29;
    color: white;
}

.actionButtonCHAT {
    padding: 10px 15px;
    background: linear-gradient(to right, #007bff, #00d4ff);
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}

.actionButtonCHAT:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 212, 255, 0.5);
}
/* Wallet & Financial Dashboard */
.mainContentCHAT {
    flex: 1;
    padding: 20px;
    background: #12121b;
    color: white;
    display: flex;
    flex-direction: column;
}

/* Sidebar */
.sidebarCHAT {
    width: 250px;
    background: linear-gradient(to bottom, #2a2a40, #1f1f30);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    box-shadow: 2px 0 15px rgba(0, 0, 0, 0.4);
}

.logoCHAT {
    font-size: 2rem;
    margin-bottom: 30px;
    color: #00d4ff;
    text-transform: uppercase;
    text-shadow: 0 0 10px #00d4ff, 0 0 20px #007bff;
}

.navLinksCHAT {
    list-style: none;
    padding: 0;
    margin: 0;
    width: 100%;
}

.navLinkCHAT {
    width: 100%;
    margin: 15px 0;
    text-align: center;
}

.navLinkCHAT a {
    color: white;
    text-decoration: none;
    font-size: 1.2rem;
    display: block;
    padding: 10px;
    transition: background 0.3s;
}

.navLinkCHAT a:hover {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
}

/* Header */
.headerCHAT {
    font-size: 2rem;
    margin-bottom: 30px;
    text-align: center;
    color: white;
}

/* Wallet Section */
.walletSectionCHAT {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
}

.walletCardCHAT {
    background: #1b1b29;
    padding: 20px;
    width: 45%;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
}

.walletCardCHAT h3 {
    margin-bottom: 10px;
}

.walletCardCHAT p {
    font-size: 2rem;
    font-weight: bold;
}

/* Transaction History Section */
.transactionSectionCHAT {
    margin-bottom: 30px;
}

.transactionTableCHAT {
    width: 100%;
    border-collapse: collapse;
}

.transactionTableCHAT th,
.transactionTableCHAT td {
    padding: 15px;
    text-align: left;
}

.transactionTableCHAT th {
    background: #2a2a40;
    color: white;
}

.transactionTableCHAT td {
    background: #1b1b29;
    color: white;
}

/* Add Transaction Section */
.addTransactionCHAT {
    background: #1b1b29;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.6);
}

.inputFieldCHAT {
    margin-bottom: 20px;
    width: 100%;
}

.inputLabelCHAT {
    display: block;
    color: white;
    margin-bottom: 5px;
    font-size: 1rem;
}

.inputCHAT {
    width: 100%;
    padding: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 1rem;
    outline: none;
}

.inputCHAT::placeholder {
    color: rgba(255, 255, 255, 0.5);
}
    /* استایل دکمه‌های حالت، آپلود فایل و toggle تاریخچه */
    .controlsContainer {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .modeSelect, .fileInput, .toggleHistory {
      padding: 8px 12px;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      background: linear-gradient(to right, #007bff, #00d4ff);
      color: white;
      cursor: pointer;
      transition: transform 0.3s;
    }
    .modeSelect:hover, .fileInput:hover, .toggleHistory:hover {
      transform: scale(1.05);
    }
    /* دکمه ارسال (Send) با افکت لودینگ */
    #sendButton {
      padding: 10px 20px;
      border: none;
      border-radius: 30px;
      font-size: 1rem;
      background: linear-gradient(to right, #007bff, #00d4ff);
      color: white;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    #sendButton.processing {
      background: #999;
      cursor: not-allowed;
    }
    /* استایل لیست مدل‌ها در سایدبار */
    .modelsList {
      list-style: none;
      padding: 0;
      margin: 0;
      width: 100%;
    }
    .modelItem {
      padding: 15px 20px;
      margin-bottom: 10px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      cursor: pointer;
      color: #222222;
      font-size: 1rem;
      transition: background 0.3s, transform 0.2s;
    }
    .modelItem:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.05);
    }
    .activeModel {
      background: linear-gradient(to right, #007bff, #00d4ff);
    }
    /* هدر بالا */
    .topHeader {
      text-align: center;
      padding: 10px;
      font-size: 1.8rem;
      color: white;
      background: #1e1e2f;
    }
  </style>
</head>
<body class="bodyCHAT">
  <!-- هدر بالا -->
  <div class="topHeader">persian AI - {{ model_name }}</div>
  <div class="containerCHAT">
    <!-- Sidebar: لیست مدل‌ها -->
    <div class="sidebarCHAT">
      <div class="logoCHAT">Models</div>
      <ul class="modelsList">
        {% for m in models %}
        <li class="modelItem {% if m == model_name %}activeModel{% endif %}">
          <a href="/?model={{ m }}" style="color: inherit; text-decoration: none;">{{ m }}</a>
        </li>
        {% endfor %}
      </ul>
    </div>
    <!-- Chat Window -->
    <div class="chatWindowCHAT">
      <!-- Header صفحه چت -->
      <div class="headerCHAT">
        Chat with {{ model_name }}
      </div>
      <!-- Messages -->
      <div class="messagesCHAT" id="messages">
        <div class="messageCHAT botCHAT">
          سلام، چگونه می‌توانم کمکتان کنم؟
        </div>
      </div>
      <!-- Input Container -->
      <div class="inputContainerCHAT">
        <div class="controlsContainer">
          <!-- منوی کشویی انتخاب حالت -->
          <select id="modeSelect" class="modeSelect">
            <option value="default">Default</option>
            <option value="argumentative">Argumentative</option>
            <option value="creative">Creative</option>
            <option value="deepthink">DeepThink</option>
            <option value="human">Human</option>
            <option value="textgenerate">TextGenerate</option>
            <option value="search">Search</option>
          </select>
          <!-- دکمه آپلود فایل -->
          <input type="file" id="fileInput" class="fileInput">
          <!-- دکمه toggle تاریخچه -->
          <button id="toggleHistory" class="toggleHistory">تاریخچه: روشن</button>
        </div>
        <!-- ورودی پیام -->
        <input type="text" id="messageInput" class="inputCHAT" placeholder="پیام خود را تایپ کنید...">
        <button id="sendButton" class="sendButtonCHAT">Send</button>
    </div>
  </div>
</div>
<script>
  useHistory = true;
  document.getElementById("toggleHistory").addEventListener("click", function() {
    useHistory = !useHistory;
    this.innerText = "تاریخچه: " + (useHistory ? "روشن" : "خاموش");
  });
  // دکمه ارسال پیام
  document.getElementById("sendButton").addEventListener("click", function() {
    const sendButton = this;
    const message = document.getElementById("messageInput").value;
    const mode = document.getElementById("modeSelect").value;
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];
    if (!message.trim()) return;
    sendButton.disabled = true;
    sendButton.classList.add("processing");
    sendButton.innerText = "در حال پردازش...";
    const formData = new FormData();
    formData.append("message", message);
    formData.append("mode", mode);
    formData.append("use_history", useHistory);
    if (file) {
        formData.append("file", file);
    }
    fetch("/send", {
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        const messagesDiv = document.getElementById("messages");
        const userMsgDiv = document.createElement("div");
        userMsgDiv.className = "messageCHAT userCHAT";
        userMsgDiv.innerText = message;
        messagesDiv.appendChild(userMsgDiv);
        const botMsgDiv = document.createElement("div");
        botMsgDiv.className = "messageCHAT botCHAT";
        botMsgDiv.innerText = data.response;
        messagesDiv.appendChild(botMsgDiv);
        document.getElementById("messageInput").value = "";
        fileInput.value = "";
        sendButton.disabled = false;
        sendButton.classList.remove("processing");
        sendButton.innerText = "Send";
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    })
    .catch(err => {
        console.error(err);
        sendButton.disabled = false;
        sendButton.classList.remove("processing");
        sendButton.innerText = "Send";
    });
  });
</script>
</body>
</html>
